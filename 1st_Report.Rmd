---
title: '**First Part: COVID-19 in Spain**'
subtitle: '**Advanced Regression And Prediction**'
author: '*Roberto Jes√∫s Alcaraz Molina*'
date: "09/05/2021"
output:
  pdf_document:
    number_section: true
    highlight: tango
    fig_caption: yes
    toc: true
    # toc_depth: 4
header-includes: 
- \usepackage{float}
- \usepackage{amsbsy}
- \usepackage{amsmath}
- \usepackage{graphicx}
- \usepackage{subfig}
- \usepackage{booktabs}
bibliography: references.bib
---

```{=tex}
\begin{center}
\includegraphics[width=3in]{logouc3m}
\end{center}
```
\newpage

```{r, echo = F}
pacman::p_load(COVID19, tidyverse, tidymodels)

# spain <- COVID19::covid19(country = "spain", start = "2020-01-22", end = "2021-04-16")
# 
# clm <- COVID19::covid19(country = "spain", level = 2, start = "2020-01-22", end = "2021-04-16") %>% 
#   filter(administrative_area_level_2 == "Castilla-La Mancha")
# 
# madrid <- COVID19::covid19(country = "spain", level = 2, start = "2020-01-22", end = "2021-04-16") %>% 
#   filter(administrative_area_level_2 == "Comunidad de Madrid")

saveRDS(spain, "spain.RDS")
saveRDS(clm, "clm.RDS")
saveRDS(madrid, "madrid.RDS")
```

```{r include=FALSE}
knitr::opts_chunk$set(warning = FALSE, 
                      echo = F, 
                      message = FALSE,
                      eval = F,
                      fig.pos="H", 
                      fig.align="center",
                      fig.width=15,
                      cache=FALSE, error = TRUE)
```

# Introduction

The aim of this project is to analyze the coronavirus pandemic (COVID-19) in Spain in general, and in Castilla-La Mancha and Comunidad de Madrid regions, in particular, in order to see what would have happened if policy measures had been taken before. The data has been taken from the R package `COVID19` [@guidotti2020].

```{r}
spain <- readRDS("spain.RDS")
clm <- readRDS("clm.RDS")
madrid <- readRDS("madrid.RDS")
```

# Data Cleaning 

https://covid19datahub.io/articles/doc/data.html

These three COVID-19 data sets contain 451 observations, which are the days from the 22nd of January 2020 until the 16th of March 2021, and 36 and 38 variables for Spain and the regions respectively, divided in 5 categories: *identifiers*, *COVID-19 variables*, *policy measures*, *geographic information* and *external keys*.

Regarding the *identifiers*, we will select both variables: `id`, which denote the country or the region, and `date`. In the second group, we have variables related with the *COVID-19* such as the cumulative number of `deaths`, `confirmed` cases, `test`, etc. For the moment, we will select all of them and then we will decide. In the *policy measures*, we have very important variables for the development of the pandemic and for our study, like `workplace_closing`, `stay_home_restrictions` or `internal_movement_restrictions`, so we must take them into account. Finally, there are other geographical variables that could be interesting for our models.

```{r}
# Transform the id
clm$id    <- clm$key 
madrid$id <- madrid$key

# Tranform the latitude and longitude
clm$latitude <- 39
clm$longitude <- -3
madrid$latitude <- 40
madrid$longitude <- -4
```

```{r}
spain <- spain %>%
  select(id, date, deaths, confirmed, tests, vaccines, recovered, hosp, icu, vent, stay_home_restrictions, school_closing, workplace_closing, transport_closing, gatherings_restrictions, internal_movement_restrictions, testing_policy, population, latitude, longitude)

clm <- clm %>%
  select(id, date, deaths, confirmed, tests, vaccines, recovered, hosp, icu, vent, stay_home_restrictions, school_closing, workplace_closing, transport_closing, gatherings_restrictions, internal_movement_restrictions, testing_policy, population, latitude, longitude)

madrid <- madrid %>%
  select(id, date, deaths, confirmed, tests, vaccines, recovered, hosp, icu, vent, stay_home_restrictions, school_closing, workplace_closing, transport_closing, gatherings_restrictions, internal_movement_restrictions, testing_policy, population, latitude, longitude)
```



### Identifiers:
- `id`:
- `date`:




```{r}

```



# Exploratoy Data Analysis (EDA)


# Feature Engineering 


# Model tuning and selection


# References
